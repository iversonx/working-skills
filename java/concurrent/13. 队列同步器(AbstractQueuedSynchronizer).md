AbstractQueuedSynchronizer是用来构建锁或其他同步组件的基础框架。它使用一个int成员变量表示同步状态，通过内置的FIFO队列来完成资源获取线程的排队工作。

###### 同步队列

队列同步器内部使用一个FIFO双向队列来完成同步状态的管理。队列中节点Node用来保存获取同步状态失败的线程引用、等待状态以及前驱节点和后继节点。

同步队列中，首节点为获取同步状态成功的节点，首节点的线程在释放同步状态时，会唤醒后继节点，而后继节点在获取同步状态成功时将自己设置为首节点。

同步器包含两个Node类型的引用：一个指向头节点，一个指向尾节点。

###### 独占式同步状态的流程

- 线程获取同步状态失败后，会构造根据线程构造一个Node，加入队列的尾部；

- Node进入同步队列后，就进入一个自旋的过程，观察自己的前驱节点是否为头节点，并尝试获取同步状态；如果上面的条件满足，则退出自旋；否则留在自旋过程中，并阻塞节点的线程。

- 当获取同步状态成功的线程执行完逻辑后，会释放同步状态并唤醒其后继节点；此时后继节点继续进行自旋，并尝试获取同步状态；如果获取同步状态成功，则将自己设为头节点。
